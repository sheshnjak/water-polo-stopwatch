<!DOCTYPE html>
<html ng-app="metalCalculator">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Kalkulator mase metalnih profila - brzo i precizno izraƒçunavanje mase ƒçelika, aluminija i drugih metala by .:sheshnjak:.">
  <meta name="theme-color" content="#64748b">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Metal mass calculator">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  <link rel="apple-touch-icon" href="icon-192.png">
  <title>Kalkulator mase metala - HSTec</title>
  <script src="angular.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #ffffff;
      color: #1a1a1a;
      line-height: 1.6;
      overflow-x: hidden;
    }

    .header {
      background: linear-gradient(135deg, #64748b 0%, #475569 100%);
      color: white;
      padding: 0.5rem 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .header h1 {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0;
    }

    .header p {
      opacity: 0.9;
      font-size: 0.8rem;
      margin: 0;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 1rem;
    }

    .calculator-grid {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 1rem;
      margin-top: 0.5rem;
    }

    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .card {
      background: #f8fafc;
      border-radius: 8px;
      padding: 0.75rem;
      border: 1px solid #e2e8f0;
    }

    .card h2 {
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
      color: #1e293b;
      font-weight: 600;
    }

    .shape-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.4rem;
    }

    .shape-btn {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      padding: 0.5rem 0.25rem;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
    }

    .shape-btn:hover {
      border-color: #2563eb;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
    }

    .shape-btn.active {
      border-color: #2563eb;
      background: #eff6ff;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .shape-icon {
      font-size: 1.5rem;
      color: #475569;
    }

    .shape-btn.active .shape-icon {
      color: #2563eb;
    }

    .shape-name {
      font-size: 0.7rem;
      color: #64748b;
      font-weight: 500;
    }

    .shape-btn.active .shape-name {
      color: #2563eb;
      font-weight: 600;
    }

    .material-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 0.4rem;
    }

    .material-btn {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      padding: 0.5rem 0.65rem;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: left;
      display: flex;
      flex-direction: column;
      gap: 0.15rem;
    }

    .material-btn:hover {
      border-color: #2563eb;
      transform: translateX(2px);
    }

    .material-btn.active {
      border-color: #2563eb;
      background: #eff6ff;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .material-name {
      font-weight: 600;
      color: #1e293b;
      font-size: 0.85rem;
    }

    .material-density {
      font-size: 0.7rem;
      color: #64748b;
    }

    .main-content {
      background: white;
      border-radius: 8px;
      padding: 1rem;
      border: 1px solid #e2e8f0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    .section {
      margin-bottom: 1rem;
    }

    .section-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .section-title::before {
      content: '';
      width: 3px;
      height: 16px;
      background: #2563eb;
      border-radius: 2px;
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.75rem;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .input-label {
      font-size: 0.8rem;
      font-weight: 500;
      color: #475569;
    }

    .input-wrapper {
      position: relative;
    }

    .input-field {
      width: 100%;
      padding: 0.5rem 0.75rem 0.5rem 3rem;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      font-size: 0.95rem;
      transition: all 0.2s ease;
      background: white;
      font-weight: 500;
    }

    .input-field:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .input-unit {
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.8rem;
      color: #64748b;
      font-weight: 500;
      pointer-events: none;
    }

    .results-card {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1rem;
    }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 0.75rem;
    }

    .result-item {
      background: white;
      padding: 0.75rem;
      border-radius: 6px;
      border: 1px solid #e2e8f0;
      transition: all 0.2s ease;
    }

    .result-item:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transform: translateY(-2px);
    }

    .result-label {
      font-size: 0.7rem;
      color: #64748b;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.35rem;
    }

    .result-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1e293b;
      font-variant-numeric: tabular-nums;
    }

    .result-unit {
      font-size: 0.9rem;
      color: #64748b;
      font-weight: 500;
      margin-left: 0.25rem;
    }

    .info-box {
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      border-radius: 6px;
      padding: 0.65rem;
      margin-top: 0.75rem;
      display: flex;
      gap: 0.5rem;
      align-items: start;
    }

    .info-icon {
      color: #2563eb;
      font-size: 1rem;
      flex-shrink: 0;
    }

    .info-text {
      font-size: 0.75rem;
      color: #1e40af;
      line-height: 1.4;
    }

    .keyboard-hint {
      font-size: 0.7rem;
      color: #94a3b8;
      font-style: italic;
      margin-left: auto;
    }

    .add-to-list-btn {
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
      color: white;
      border: none;
      border-radius: 6px;
      padding: 0.6rem 1rem;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
    }

    .add-to-list-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
    }

    .add-to-list-btn:disabled {
      background: #94a3b8;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .parts-list-section {
      background: white;
      border-radius: 8px;
      padding: 1rem;
      border: 1px solid #e2e8f0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      margin-top: 1.5rem;
    }

    .parts-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.75rem;
    }

    .parts-list-actions {
      display: flex;
      gap: 0.5rem;
    }

    .action-btn {
      padding: 0.5rem 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.875rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .action-btn.export {
      background: #10b981;
      color: white;
      border-color: #10b981;
    }

    .action-btn.export:hover {
      background: #059669;
    }

    .action-btn.clear {
      background: #ef4444;
      color: white;
      border-color: #ef4444;
    }

    .action-btn.clear:hover {
      background: #dc2626;
    }

    .parts-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.75rem;
    }

    .parts-table thead {
      background: #f8fafc;
    }

    .parts-table th {
      padding: 0.5rem 0.5rem;
      text-align: left;
      font-weight: 600;
      color: #475569;
      border-bottom: 2px solid #e2e8f0;
      font-size: 0.7rem;
    }

    .parts-table td {
      padding: 0.5rem 0.5rem;
      border-bottom: 1px solid #e2e8f0;
      color: #1e293b;
    }

    .parts-table tr:hover {
      background: #f8fafc;
    }

    .delete-btn {
      background: none;
      border: none;
      color: #ef4444;
      cursor: pointer;
      padding: 0.25rem;
      font-size: 1.2rem;
      transition: all 0.2s ease;
    }

    .delete-btn:hover {
      color: #dc2626;
      transform: scale(1.2);
    }

    .total-row {
      font-weight: 700;
      background: #f1f5f9 !important;
      border-top: 2px solid #cbd5e1;
    }

    .total-row td {
      padding: 1rem;
      font-size: 1rem;
    }

    @media (max-width: 968px) {
      .calculator-grid {
        grid-template-columns: 1fr;
      }
    }
	a.brend{
		color: white;
		text-decoration: none;
	}
  </style>
</head>
<body ng-controller="CalculatorCtrl">
  <div class="header">
    <div class="header-content">
      <h1>üîß Kalkulator Mase Metala</h1>
      <p>Brzo i precizno izraƒçunavanje mase metalnih profila by <a href="https://tomislavdekovic.iz.hr" class="brend">.:sheshnjak:.</a>.</p>
    </div>
  </div>

  <div class="container">
    <div class="calculator-grid">
      <div class="sidebar">
        <div class="card">
          <h2>Odaberite oblik</h2>
          <div class="shape-grid">
            <button class="shape-btn" 
                    ng-repeat="shape in shapes"
                    ng-class="{active: currentShape.id === shape.id}"
                    ng-click="selectShape(shape)">
              <div class="shape-icon" ng-bind="shape.icon"></div>
              <div class="shape-name" ng-bind="shape.name"></div>
            </button>
          </div>
        </div>

        <div class="card">
          <h2>Odaberite materijal</h2>
          <div class="material-grid">
            <button class="material-btn"
                    ng-repeat="material in materials"
                    ng-class="{active: currentMaterial.id === material.id}"
                    ng-click="selectMaterial(material)">
              <div class="material-name" ng-bind="material.name"></div>
              <div class="material-density" ng-bind="material.density + ' kg/m¬≥'"></div>
            </button>
          </div>
        </div>
      </div>

      <div class="main-content">
        <div class="card">
          <div class="section">
            <div class="section-title">
              Dimenzije (mm)
              <span class="keyboard-hint">Pritisnite Enter za sljedeƒáe polje</span>
            </div>
            <div class="input-grid">
              <div class="input-group" ng-repeat="field in currentShape.fields">
                <label class="input-label">
                  <span ng-bind="getFieldLabel(field)"></span>
                </label>
                <div class="input-wrapper">
                  <span class="input-unit">mm</span>
                  <input type="number"
                         class="input-field"
                         id="input-{{field}}"
                         ng-model="dimensions[field]"
                         ng-change="onDimensionChange(field)"
                         ng-keydown="handleEnter($event, $index)"
                         ng-focus="selectAll($event)"
                         ng-click="selectAll($event)"
                         placeholder="0"
                         step="1"
                         min="1">
                </div>
              </div>
              
              <div class="input-group">
                <label class="input-label">Koliƒçina</label>
                <div class="input-wrapper">
                  <span class="input-unit">kom</span>
                  <input type="number"
                         class="input-field"
                         id="input-quantity"
                         ng-model="quantity"
                         ng-keydown="handleEnter($event, currentShape.fields.length)"
                         ng-focus="selectAll($event)"
                         ng-click="selectAll($event)"
                         placeholder="1"
                         step="1"
                         min="1">
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="results-card">
          <div class="section-title">Rezultati</div>
          <div class="results-grid">
            <div class="result-item">
              <div class="result-label">Volumen</div>
              <div class="result-value">
                <span ng-bind="calculateVolume() | number:4"></span>
                <span class="result-unit">m¬≥</span>
              </div>
            </div>
            <div class="result-item">
              <div class="result-label">Masa (<span ng-bind="currentMaterial.name"></span>)</div>
              <div class="result-value">
                <span ng-bind="calculateMass() | number:3"></span>
                <span class="result-unit">kg</span>
              </div>
            </div>
            <div class="result-item" ng-if="quantity > 1">
              <div class="result-label">Ukupna masa</div>
              <div class="result-value">
                <span ng-bind="(calculateMass() * quantity) | number:3"></span>
                <span class="result-unit">kg</span>
              </div>
            </div>
            <div class="result-item" ng-if="quantity > 1">
              <div class="result-label">Masa po komadu</div>
              <div class="result-value">
                <span ng-bind="calculateMass() | number:3"></span>
                <span class="result-unit">kg</span>
              </div>
            </div>
          </div>

          <div class="info-box">
            <div class="info-icon">‚ÑπÔ∏è</div>
            <div class="info-text">
              <strong>Formula:</strong> Masa = Volumen √ó Gustoƒáa √ó Koliƒçina<br>
              <strong>Gustoƒáa <span ng-bind="currentMaterial.name"></span>:</strong> <span ng-bind="currentMaterial.density"></span> kg/m¬≥
            </div>
          </div>

          <button class="add-to-list-btn" 
                  ng-click="addToPartsList()"
                  ng-disabled="!isValidForList()">
            <span>‚ûï</span>
            Dodaj u listu dijelova
          </button>
        </div>
      </div>
    </div>

    <div class="parts-list-section" ng-if="partsList.length > 0">
      <div class="parts-list-header">
        <div class="section-title">Lista dijelova</div>
        <div class="parts-list-actions">
          <button class="action-btn export" ng-click="exportToCSV()">
            <span>üì•</span>
            CSV
          </button>
          <button class="action-btn clear" ng-click="clearPartsList()">
            <span>üóëÔ∏è</span>
          </button>
        </div>
      </div>

      <table class="parts-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Oblik</th>
            <th>Materijal</th>
            <th>Dim. (mm)</th>
            <th>Kom</th>
            <th>Masa (kg)</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="part in partsList track by $index">
            <td ng-bind="$index + 1"></td>
            <td ng-bind="part.shapeName"></td>
            <td ng-bind="part.materialName"></td>
            <td ng-bind="part.dimensionsText" style="font-size: 0.7rem;"></td>
            <td ng-bind="part.quantity"></td>
            <td><strong ng-bind="part.totalMass | number:3"></strong></td>
            <td>
              <button class="delete-btn" ng-click="removeFromList($index)">√ó</button>
            </td>
          </tr>
          <tr class="total-row">
            <td colspan="5" style="text-align: right;">UKUPNO:</td>
            <td colspan="2"><strong ng-bind="(getTotalMass() | number:3) + ' kg'"></strong></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    angular.module('metalCalculator', [])
      .controller('CalculatorCtrl', ['$scope', function($scope) {
        $scope.shapes = [
          { id: 'round', name: 'Okrugla ≈°ipka', icon: '‚óè', fields: ['diameter', 'length'] },
          { id: 'square', name: 'Kvadratna ≈°ipka', icon: '‚ñ†', fields: ['width', 'length'] },
          { id: 'rectangle', name: 'Pravokutna ≈°ipka', icon: '‚ñ≠', fields: ['width', 'height', 'length'] },
          { id: 'tube', name: 'Cijev', icon: '‚óã', fields: ['diameter', 'thickness', 'length'] },
          { id: 'squareTube', name: 'Kvadratna cijev', icon: '‚ñ°', fields: ['width', 'thickness', 'length'] },
          { id: 'hexagon', name: '≈†esterokutna ≈°ipka', icon: '‚¨°', fields: ['width', 'length'] }
        ];

        $scope.materials = [
          { id: 'steel', name: 'ƒåelik', density: 7850 },
          { id: 'stainless', name: 'Nehrƒëajuƒái ƒçelik', density: 8000 },
          { id: 'cast_iron', name: 'Sivi lijev', density: 7200 },
          { id: 'ductile_iron', name: 'Nodularni lijev', density: 7100 },
          { id: 'aluminum', name: 'Aluminij', density: 2700 },
          { id: 'bronze', name: 'Bronca', density: 8700 },
          { id: 'brass', name: 'Mesing', density: 8500 }
        ];

        $scope.currentShape = $scope.shapes[0];
        $scope.currentMaterial = $scope.materials[0];
        $scope.dimensions = {};
        $scope.quantity = 1;
        $scope.partsList = [];

        $scope.selectShape = function(shape) {
          var oldDims = angular.copy($scope.dimensions);
          $scope.currentShape = shape;
          $scope.dimensions = {};
          
          shape.fields.forEach(function(field) {
            if (oldDims[field]) {
              $scope.dimensions[field] = oldDims[field];
            } else {
              if (field === 'width' && oldDims.diameter) {
                $scope.dimensions[field] = oldDims.diameter;
              } else if (field === 'height' && oldDims.diameter) {
                $scope.dimensions[field] = oldDims.diameter;
              } else if (field === 'diameter' && oldDims.width) {
                $scope.dimensions[field] = oldDims.width;
              } else if (field === 'thickness' && !oldDims.thickness) {
                $scope.dimensions[field] = 1;
              } else if (field === 'length' && oldDims.length) {
                $scope.dimensions[field] = oldDims.length;
              }
            }
          });
        };

        $scope.selectMaterial = function(material) {
          $scope.currentMaterial = material;
        };

        $scope.selectAll = function(event) {
          setTimeout(function() {
            event.target.select();
          }, 0);
        };

        $scope.onDimensionChange = function(field) {
          if ($scope.dimensions[field] !== null && $scope.dimensions[field] !== undefined && $scope.dimensions[field] !== '') {
            var val = parseFloat($scope.dimensions[field]);
            if (!isNaN(val) && val > 0) {
              $scope.dimensions[field] = Math.round(val);
            }
          }
        };

        $scope.getFieldLabel = function(field) {
          var labels = {
            diameter: 'Promjer (√ò)',
            length: 'Duljina (L)',
            width: '≈†irina (B)',
            height: 'Visina (H)',
            thickness: 'Debljina stijenke (t)'
          };
          return labels[field] || field;
        };

        $scope.getDimensionsText = function() {
          var dims = [];
          $scope.currentShape.fields.forEach(function(field) {
            var value = $scope.dimensions[field];
            if (value) {
              var label = $scope.getFieldLabel(field).split(' ')[0];
              dims.push(label + ': ' + Math.round(value));
            }
          });
          return dims.join(', ');
        };

        $scope.isValidForList = function() {
          var allFieldsFilled = $scope.currentShape.fields.every(function(field) {
            return $scope.dimensions[field] && parseFloat($scope.dimensions[field]) > 0;
          });
          return allFieldsFilled && $scope.quantity > 0;
        };

        $scope.addToPartsList = function() {
          if (!$scope.isValidForList()) return;

          var mass = $scope.calculateMass();
          var totalMass = mass * $scope.quantity;

          var part = {
            shapeName: $scope.currentShape.name,
            shapeId: $scope.currentShape.id,
            materialName: $scope.currentMaterial.name,
            materialDensity: $scope.currentMaterial.density,
            dimensions: angular.copy($scope.dimensions),
            dimensionsText: $scope.getDimensionsText(),
            quantity: $scope.quantity,
            mass: mass,
            totalMass: totalMass
          };

          $scope.partsList.push(part);
        };

        $scope.removeFromList = function(index) {
          $scope.partsList.splice(index, 1);
        };

        $scope.clearPartsList = function() {
          if (confirm('Jeste li sigurni da ≈æelite obrisati sve dijelove iz liste?')) {
            $scope.partsList = [];
          }
        };

        $scope.getTotalMass = function() {
          return $scope.partsList.reduce(function(sum, part) {
            return sum + part.totalMass;
          }, 0);
        };

        $scope.exportToCSV = function() {
          if ($scope.partsList.length === 0) return;

          var csv = 'Redni broj,Oblik,Materijal,Dimenzije (mm),Koliƒçina,Masa po komadu (kg),Ukupna masa (kg)\n';
          
          $scope.partsList.forEach(function(part, index) {
            csv += (index + 1) + ',';
            csv += '"' + part.shapeName + '",';
            csv += '"' + part.materialName + '",';
            csv += '"' + part.dimensionsText + '",';
            csv += part.quantity + ',';
            csv += part.mass.toFixed(3) + ',';
            csv += part.totalMass.toFixed(3) + '\n';
          });

          csv += ',,,,,UKUPNO,' + $scope.getTotalMass().toFixed(3) + '\n';

          var blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
          var link = document.createElement('a');
          var url = URL.createObjectURL(blob);
          
          link.setAttribute('href', url);
          link.setAttribute('download', 'lista_dijelova_' + new Date().toISOString().split('T')[0] + '.csv');
          link.style.visibility = 'hidden';
          
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        };

        $scope.handleEnter = function(event, index) {
          if (event.keyCode === 13) {
            event.preventDefault();
            var allFields = $scope.currentShape.fields.concat(['quantity']);
            var nextIndex = index + 1;
            
            if (nextIndex < allFields.length) {
              var nextField = allFields[nextIndex];
              var nextInput = document.getElementById('input-' + nextField);
              if (nextInput) {
                nextInput.focus();
                nextInput.select();
              }
            } else {
              // Last field - return to first field
              var firstField = $scope.currentShape.fields[0];
              var firstInput = document.getElementById('input-' + firstField);
              if (firstInput) {
                firstInput.focus();
                firstInput.select();
              }
            }
          }
        };

        $scope.calculateVolume = function() {
          if (!$scope.dimensions) {
            return 0;
          }

          var d = parseInt($scope.dimensions.diameter) || 0;
          var l = parseInt($scope.dimensions.length) || 0;
          var w = parseInt($scope.dimensions.width) || 0;
          var h = parseInt($scope.dimensions.height) || 0;
          var t = parseInt($scope.dimensions.thickness) || 0;

          var dM = d / 1000;
          var lM = l / 1000;
          var wM = w / 1000;
          var hM = h / 1000;
          var tM = t / 1000;

          var volume = 0;

          switch ($scope.currentShape.id) {
            case 'round':
              if (d > 0 && l > 0) {
                volume = Math.PI * Math.pow(dM / 2, 2) * lM;
              }
              break;
            case 'square':
              if (w > 0 && l > 0) {
                volume = Math.pow(wM, 2) * lM;
              }
              break;
            case 'rectangle':
              if (w > 0 && h > 0 && l > 0) {
                volume = wM * hM * lM;
              }
              break;
            case 'tube':
              if (d > 0 && t > 0 && l > 0 && d > 2 * t) {
                var outerArea = Math.PI * Math.pow(dM / 2, 2);
                var innerArea = Math.PI * Math.pow((dM - 2 * tM) / 2, 2);
                volume = (outerArea - innerArea) * lM;
              }
              break;
            case 'squareTube':
              if (w > 0 && t > 0 && l > 0 && w > 2 * t) {
                var outerVol = Math.pow(wM, 2);
                var innerVol = Math.pow(wM - 2 * tM, 2);
                volume = (outerVol - innerVol) * lM;
              }
              break;
            case 'hexagon':
              if (w > 0 && l > 0) {
                volume = (3 * Math.sqrt(3) / 2) * Math.pow(wM / 2, 2) * lM;
              }
              break;
          }

          return volume || 0;
        };

        $scope.calculateMass = function() {
          var volume = $scope.calculateVolume();
          var density = $scope.currentMaterial.density;
          return volume * density;
        };
      }]);
  </script>
  
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('service-worker.js').then(function(registration) {
          // Service Worker registered
        }, function(err) {
          // Service Worker registration failed
        });
      });
    }
  </script>
</body>
</html>